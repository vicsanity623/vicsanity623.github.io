<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tap Guardian RPG</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Google Fonts for "Press Start 2P" -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="main-menu" class="menu-container visible">
        <h1>Tap Guardian RPG</h1>
        <div id="userStatus">Loading user status...</div>
        <div id="user-display" style="display: none;">
            <p>Welcome, <span id="userName"></span>!</p>
            <button id="signOutBtn" class="menu-button">Sign Out</button>
        </div>
        <button id="newGameBtn" class="menu-button">New Game</button>
        <div id="load-options-container">
            <!-- Load game buttons will be inserted here by JavaScript -->
        </div>
        <button id="googleSignInBtn" class="menu-button">Sign in with Google</button>
    </div>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>

        <!-- Heads-Up Display (HUD) -->
        <div id="hud-top-left" class="hud">
            <span id="level-text">LV 1</span>
            <div id="hp-bar-container">
                <div id="hp-bar-fill"></div>
            </div>
            <span id="hp-text">100/100</span>
            
            <!-- NEW: Stage and Wave Info -->
            <div id="stage-wave-info">
                <span id="stage-text">STAGE: 1</span>
                <span id="wave-text">WAVE: 1/5</span>
            </div>
            <!-- END NEW -->

            <div id="upgrade-stats-list">
                <!-- Dynamic stats list will be injected here -->
            </div>
        </div>

        <div id="hud-top-right" class="hud">
            <span id="timer-text">00:00</span>
            <span id="kill-counter-text">0</span> Kills
        </div>

        <div id="xp-bar-bottom-container">
            <div id="xp-bar-bottom-fill"></div>
        </div>

        <!-- NEW: Next Wave Incoming message overlay -->
        <div id="next-wave-message">NEXT WAVE INCOMING IN: 3s</div>

        <!-- NEW: Boss Health Bar -->
        <div id="boss-health-bar-container">
            <div id="boss-health-bar-fill"></div>
        </div>

        <!-- Level Up Window (Modal) -->
        <div id="level-up-window" class="modal">
            <h2>SELECT POWER</h2>
            <span id="level-up-timer-display"></span>
            <div id="upgrade-options">
                <!-- Upgrade cards will be dynamically inserted here -->
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="modal">
            <h2>GAME OVER</h2>
            <p>Time Survived: <span id="final-time-text">00:00</span></p>
            <p>Final Level: <span id="final-level-text">0</span></p>
            <p>Enemies Slain: <span id="final-kills-text">0</span></p>
            <button id="restart-button" class="menu-button">Restart</button>
        </div>

        <button id="auto-mode-button">AUTO OFF</button>
        <button id="hyperBeamButton">Hyper Beam</button>
    </div>

    <!-- Firebase App (required for Auth and Firestore) -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>

    <!-- Your game scripts -->
    <script type="module" src="systemsmanager.js"></script>
    <script type="module">
        import { initializeApp } from './systemsmanager.js';
        initializeApp();
    </script>
</body>
</html>
